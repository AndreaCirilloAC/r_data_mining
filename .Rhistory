cost_income,
ROE,
employees,
economic_sector,
ROS,
company_revenues,
commercial_portfolio,
business_unit) %>%
mutate(commercial_portfolio = as.factor(commercial_portfolio),
business_unit = as.factor(business_unit))->wrangled_me_customer_list
levels(wrangled_me_customer_list$commercial_portfolio) <- levels(training_data_factor$commercial_portfolio)
levels(wrangled_me_customer_list$business_unit) <- levels(training_data_factor$business_unit)
me_customer_list$logistic <- predict.glm(logistic,newdata = wrangled_me_customer_list)
me_customer_list$svm <- predict(support_vector_machine_linear,newdata = random_forest_data)
me_customer_list$random_forest <-predict(random_forest,newdata = random_forest_data)
me_customer_list %>%
mutate(logistic_threshold = case_when(as.numeric(logistic)>0.5 ~ 1,
TRUE ~ 0),
svm_threshold = case_when(as.numeric(svm)>0.5 ~ 1,
TRUE ~ 0)) %>%
mutate(ensemble_prediction = case_when(logistic_threshold+svm_threshold+ as.numeric(as.character(random_forest)) >=2 ~ 1,
TRUE ~ 0)) ->  me_customer_list_complete
me_customer_list_complete %>% filter(ensemble_prediction == 1) %>% select(company_name) -> defaulted
set.seed(20)
me_customer_list$svm <- predict(support_vector_machine_linear,newdata = random_forest_data)
me_customer_list$random_forest <-predict(random_forest,newdata = random_forest_data)
me_customer_list %>%
mutate(logistic_threshold = case_when(as.numeric(logistic)>0.5 ~ 1,
TRUE ~ 0),
svm_threshold = case_when(as.numeric(svm)>0.5 ~ 1,
TRUE ~ 0)) %>%
mutate(ensemble_prediction = case_when(logistic_threshold+svm_threshold+ as.numeric(as.character(random_forest)) >=2 ~ 1,
TRUE ~ 0)) ->  me_customer_list_complete
me_customer_list_complete %>% filter(ensemble_prediction == 1) %>% select(company_name) -> defaulted
# predicting on new data
me_customer_list <- import("middle_east_customer_list.xlsx")
me_customer_list %>%
select(corporation,
previous_default,
multiple_country,
cost_income,
ROE,
employees,
economic_sector,
ROS,
company_revenues,
commercial_portfolio,
business_unit) %>%
mutate(commercial_portfolio = as.factor(commercial_portfolio),
business_unit = as.factor(business_unit))->wrangled_me_customer_list
levels(wrangled_me_customer_list$commercial_portfolio) <- levels(training_data_factor$commercial_portfolio)
levels(wrangled_me_customer_list$business_unit) <- levels(training_data_factor$business_unit)
me_customer_list$logistic <- predict.glm(logistic,newdata = wrangled_me_customer_list)
set.seed(11)
me_customer_list$svm <- predict(support_vector_machine_linear,newdata = random_forest_data)
me_customer_list$random_forest <-predict(random_forest,newdata = random_forest_data)
me_customer_list %>%
mutate(logistic_threshold = case_when(as.numeric(logistic)>0.5 ~ 1,
TRUE ~ 0),
svm_threshold = case_when(as.numeric(svm)>0.5 ~ 1,
TRUE ~ 0)) %>%
mutate(ensemble_prediction = case_when(logistic_threshold+svm_threshold+ as.numeric(as.character(random_forest)) >=2 ~ 1,
TRUE ~ 0)) ->  me_customer_list_complete
me_customer_list_complete %>% filter(ensemble_prediction == 1) %>% select(company_name) -> defaulted
str(me_customer_list)
# predicting on new data
me_customer_list <- import("middle_east_customer_list.xlsx")
str(me_customer_list)
me_customer_list <- import("middle_east_customer_list.xlsx")
str(me_customer_list)
me_customer_list %>%
select(corporation,
previous_default,
multiple_country,
cost_income,
ROE,
employees,
economic_sector,
ROS,
company_revenues,
commercial_portfolio,
business_unit) %>%
mutate(commercial_portfolio = as.factor(commercial_portfolio),
business_unit = as.factor(business_unit))->wrangled_me_customer_list
levels(wrangled_me_customer_list$commercial_portfolio) <- levels(training_data_factor$commercial_portfolio)
levels(wrangled_me_customer_list$business_unit) <- levels(training_data_factor$business_unit)
me_customer_list$logistic <- predict.glm(logistic,newdata = wrangled_me_customer_list)
set.seed(11)
me_customer_list$svm <- predict(support_vector_machine_linear,newdata = wrangled_me_customer_list)
me_customer_list$random_forest <-predict(random_forest,newdata = wrangled_me_customer_list)
me_customer_list %>%
mutate(logistic_threshold = case_when(as.numeric(logistic)>0.5 ~ 1,
TRUE ~ 0),
svm_threshold = case_when(as.numeric(svm)>0.5 ~ 1,
TRUE ~ 0)) %>%
mutate(ensemble_prediction = case_when(logistic_threshold+svm_threshold+ as.numeric(as.character(random_forest)) >=2 ~ 1,
TRUE ~ 0)) ->  me_customer_list_complete
me_customer_list_complete %>% filter(ensemble_prediction == 1) %>% select(company_name) -> defaulted
save(defaulted,file ="../r_datamining/visure/defaults.rdata")
me_customer_list <- import("middle_east_customer_list.xlsx")
str(me_customer_list)
me_customer_list %>%
select(corporation,
previous_default,
multiple_country,
cost_income,
ROE,
employees,
economic_sector,
ROS,
company_revenues,
commercial_portfolio,
business_unit) %>%
mutate(commercial_portfolio = as.factor(commercial_portfolio),
business_unit = as.factor(business_unit))->wrangled_me_customer_list
levels(wrangled_me_customer_list$commercial_portfolio) <- levels(training_data_factor$commercial_portfolio)
levels(wrangled_me_customer_list$business_unit) <- levels(training_data_factor$business_unit)
me_customer_list$logistic <- predict.glm(logistic,newdata = wrangled_me_customer_list)
set.seed(11)
me_customer_list$svm <- predict(support_vector_machine_linear,newdata = wrangled_me_customer_list)
me_customer_list$random_forest <-predict(random_forest,newdata = wrangled_me_customer_list)
me_customer_list %>%
mutate(logistic_threshold = case_when(as.numeric(logistic)>0.5 ~ 1,
TRUE ~ 0),
svm_threshold = case_when(as.numeric(svm)>0.5 ~ 1,
TRUE ~ 0)) %>%
mutate(ensemble_prediction = case_when(logistic_threshold+svm_threshold+ as.numeric(as.character(random_forest)) >=2 ~ 1,
TRUE ~ 0)) ->  me_customer_list_complete
me_customer_list_complete %>% filter(ensemble_prediction == 1) %>% select(company_name) -> defaulted
save(defaulted,file ="../r_datamining/visure/defaults.rdata")
me_customer_list$logistic %>% head()
me_customer_list$logistic %>% head() %>% round(,2)
me_customer_list$logistic %>% head() %>% round(,3)
me_customer_list$logistic %>% head() %>% round(,4)
me_customer_list$logistic %>% head() %>% round(,5)
me_customer_list$logistic %>% head() %>% round(,6)
me_customer_list$logistic %>% head() %>% round(,7)
me_customer_list$logistic %>% head() %>% round(,8)
me_customer_list$logistic %>% head() %>% round()
me_customer_list$logistic %>% head() %>% round()
me_customer_list_complete %>% filter(ensemble_prediction == 1) -> defaulted_companies
defaulted_companies %>% export("defaulted_companies.xlsx")
library(dplyr)
library(tidyr)
library(caret)
library(randomForest)
library(e1071)
training_data %>%
select(corporation,
previous_default,
multiple_country,
cost_income,
ROE,
employees,
economic_sector,
ROS,
company_revenues,
commercial_portfolio,
business_unit) %>%
mutate(commercial_portfolio = as.factor(commercial_portfolio),
business_unit = as.factor(business_unit))->wrangled_me_customer_list
levels(wrangled_me_customer_list$commercial_portfolio) <- levels(training_data_factor$commercial_portfolio)
levels(wrangled_me_customer_list$business_unit) <- levels(training_data_factor$business_unit)
me_customer_list$logistic <- predict.glm(logistic,newdata = wrangled_me_customer_list)
set.seed(11)
# predicting on new data
training_data %>%
select(corporation,
previous_default,
multiple_country,
cost_income,
ROE,
employees,
economic_sector,
ROS,
company_revenues,
commercial_portfolio,
business_unit) %>%
mutate(commercial_portfolio = as.factor(commercial_portfolio),
business_unit = as.factor(business_unit))->wrangled_me_customer_list
levels(wrangled_me_customer_list$commercial_portfolio) <- levels(training_data_factor$commercial_portfolio)
levels(wrangled_me_customer_list$business_unit) <- levels(training_data_factor$business_unit)
wrangled_me_customer_list$logistic <- predict.glm(logistic,newdata = wrangled_me_customer_list)
set.seed(11)
wrangled_me_customer_list$random_forest <-predict(random_forest,newdata = wrangled_me_customer_list)
wrangled_me_customer_list$svm <- predict(support_vector_machine_linear,newdata = wrangled_me_customer_list)
wrangled_me_customer_list %>%
mutate(logistic_threshold = case_when(as.numeric(logistic)>0.5 ~ 1,
TRUE ~ 0),
svm_threshold = case_when(as.numeric(svm)>0.5 ~ 1,
TRUE ~ 0)) %>%
mutate(ensemble_prediction = case_when(logistic_threshold+svm_threshold+ as.numeric(as.character(random_forest)) >=2 ~ 1,
TRUE ~ 0)) ->  me_customer_list_complete
me_customer_list_complete %>% group_by(ensemble_prediction) %>% summarise (teste = n())
me_customer_list_complete %>% filter(ensemble_prediction == 1) %>%
sample_n(size = 115-42) %>%
select(corporation,
previous_default,
multiple_country,
cost_income,
ROE,
employees,
economic_sector,
ROS,
company_revenues,
commercial_portfolio,
business_unit)-> sampled_performing
me_customer_list_complete %>% filter(ensemble_prediction == 1) %>%
sample_n(size = 42) %>%
select(corporation,
previous_default,
multiple_country,
cost_income,
ROE,
employees,
economic_sector,
ROS,
company_revenues,
commercial_portfolio,
business_unit,
ensemble_prediction)-> sampled_defaulted
me_customer_list_complete %>% filter(ensemble_prediction == 1) %>%
sample_n(size = 115-42) %>%
select(corporation,
previous_default,
multiple_country,
cost_income,
ROE,
employees,
economic_sector,
ROS,
company_revenues,
commercial_portfolio,
business_unit,
ensemble_prediction)-> sampled_performing
rbind(sampled_performing,sampled_defaulted) %>% save(file= "../r_datamining/visure/company_predicted.rdata")
rbind(sampled_performing,sampled_defaulted) %>% save(file= "../r_datamining/visure/company_predicted.rdata")
rbind(sampled_performing,sampled_defaulted) ->company_predicted
save(file= "../r_datamining/visure/company_predicted.rdata")
save(company_predicted,file= "../r_datamining/visure/company_predicted.rdata")
me_customer_list_complete %>% filter(ensemble_prediction == 0) %>%
sample_n(size = 42) %>%
select(corporation,
previous_default,
multiple_country,
cost_income,
ROE,
employees,
economic_sector,
ROS,
company_revenues,
commercial_portfolio,
business_unit,
ensemble_prediction)-> sampled_defaulted
me_customer_list_complete %>% filter(ensemble_prediction == 1) %>%
sample_n(size = 115-42) %>%
select(corporation,
previous_default,
multiple_country,
cost_income,
ROE,
employees,
economic_sector,
ROS,
company_revenues,
commercial_portfolio,
business_unit,
ensemble_prediction)-> sampled_performing
rbind(sampled_performing,sampled_defaulted) ->company_predicted
save(company_predicted,file= "../r_datamining/visure/company_predicted.rdata")
me_customer_list_complete %>% filter(ensemble_prediction == 0) %>%
sample_n(size = 115-42) %>%
select(corporation,
previous_default,
multiple_country,
cost_income,
ROE,
employees,
economic_sector,
ROS,
company_revenues,
commercial_portfolio,
business_unit,
ensemble_prediction)-> sampled_performing
me_customer_list_complete %>% filter(ensemble_prediction == 1) %>%
sample_n(size = 42) %>%
select(corporation,
previous_default,
multiple_country,
cost_income,
ROE,
employees,
economic_sector,
ROS,
company_revenues,
commercial_portfolio,
business_unit,
ensemble_prediction)-> sampled_defaulted
115-42
sampled_defaulted
sample_defaul
sample_defaulted %>% nrwo()
sampled_defaulted %>% nrwo()
sampled_defaulted %>% nrow()
rbind(sampled_performing,sampled_defaulted) ->company_predicted
sampled_performing
sampled_defaulted
rbind(sampled_performing,sampled_defaulted) ->company_predicted
save(company_predicted,file= "../r_datamining/visure/company_predicted.rdata")
save(company_predicted,file= "../r_datamining/visure/company_predicted.rdata")
# predicting on new data
me_customer_list <- import("middle_east_customer_list.xlsx")
library(rio)
# predicting on new data
me_customer_list <- import("middle_east_customer_list.xlsx")
str(me_customer_list)
me_customer_list %>%
select(corporation,
previous_default,
multiple_country,
cost_income,
ROE,
employees,
economic_sector,
ROS,
company_revenues,
commercial_portfolio,
business_unit) %>%
mutate(commercial_portfolio = as.factor(commercial_portfolio),
business_unit = as.factor(business_unit))->wrangled_me_customer_list
levels(wrangled_me_customer_list$commercial_portfolio) <- levels(training_data_factor$commercial_portfolio)
levels(wrangled_me_customer_list$business_unit) <- levels(training_data_factor$business_unit)
me_customer_list$logistic <- predict.glm(logistic,newdata = wrangled_me_customer_list)
set.seed(11)
me_customer_list$random_forest <-predict(random_forest,newdata = wrangled_me_customer_list)
me_customer_list$svm <- predict(support_vector_machine_linear,newdata = wrangled_me_customer_list)
me_customer_list %>%
mutate(logistic_threshold = case_when(as.numeric(logistic)>0.5 ~ 1,
TRUE ~ 0),
svm_threshold = case_when(as.numeric(svm)>0.5 ~ 1,
TRUE ~ 0)) %>%
mutate(ensemble_prediction = case_when(logistic_threshold+svm_threshold+ as.numeric(as.character(random_forest)) >=2 ~ 1,
TRUE ~ 0)) ->  me_customer_list_complete
me_customer_list_complete %>% filter(ensemble_prediction == 1)
str(me_customer_list)
me_customer_list_complete %>% filter(ensemble_prediction == 1) -> defaulted_companies
defaulted_companies %>% export("defaulted_companies.xlsx")
me_customer_list <- import("middle_east_customer_list.xlsx")
str(me_customer_list)
me_customer_list %>%
select(corporation,
previous_default,
multiple_country,
cost_income,
ROE,
employees,
economic_sector,
ROS,
company_revenues,
commercial_portfolio,
business_unit) %>%
mutate(commercial_portfolio = as.factor(commercial_portfolio),
business_unit = as.factor(business_unit))->wrangled_me_customer_list
levels(wrangled_me_customer_list$commercial_portfolio) <- levels(training_data_factor$commercial_portfolio)
levels(wrangled_me_customer_list$business_unit) <- levels(training_data_factor$business_unit)
me_customer_list$logistic <- predict.glm(logistic,newdata = wrangled_me_customer_list)
set.seed(11)
me_customer_list$random_forest <-predict(random_forest,newdata = wrangled_me_customer_list)
me_customer_list$svm <- predict(support_vector_machine_linear,newdata = wrangled_me_customer_list)
me_customer_list %>%
mutate(logistic_threshold = case_when(as.numeric(logistic)>0.5 ~ 1,
TRUE ~ 0),
svm_threshold = case_when(as.numeric(svm)>0.5 ~ 1,
TRUE ~ 0)) %>%
mutate(ensemble_prediction = case_when(logistic_threshold+svm_threshold+ as.numeric(as.character(random_forest)) >=2 ~ 1,
TRUE ~ 0)) ->  me_customer_list_complete
me_customer_list_complete %>% filter(ensemble_prediction == 1) -> defaulted_companies
defaulted_companies %>% export("defaulted_companies.xlsx")
defaulted_companies
me_customer_list <- import("middle_east_customer_list.xlsx")
str(me_customer_list)
me_customer_list %>%
select(corporation,
previous_default,
multiple_country,
cost_income,
ROE,
employees,
economic_sector,
ROS,
company_revenues,
commercial_portfolio,
business_unit) %>%
mutate(commercial_portfolio = as.factor(commercial_portfolio),
business_unit = as.factor(business_unit))->wrangled_me_customer_list
levels(wrangled_me_customer_list$commercial_portfolio) <- levels(training_data_factor$commercial_portfolio)
levels(wrangled_me_customer_list$business_unit) <- levels(training_data_factor$business_unit)
wrangled_me_customer_list$logistic <- predict.glm(logistic,newdata = wrangled_me_customer_list)
set.seed(11)
wrangled_me_customer_list$random_forest <-predict(random_forest,newdata = wrangled_me_customer_list)
wrangled_me_customer_list$svm <- predict(support_vector_machine_linear,newdata = wrangled_me_customer_list)
wrangled_me_customer_list %>%
mutate(logistic_threshold = case_when(as.numeric(logistic)>0.5 ~ 1,
TRUE ~ 0),
svm_threshold = case_when(as.numeric(svm)>0.5 ~ 1,
TRUE ~ 0)) %>%
mutate(ensemble_prediction = case_when(logistic_threshold+svm_threshold+ as.numeric(as.character(random_forest)) >=2 ~ 1,
TRUE ~ 0)) ->  me_customer_list_complete
me_customer_list_complete %>% filter(ensemble_prediction == 1) -> defaulted_companies
defaulted_companies %>% export("defaulted_companies.xlsx")
defaulted_companies
# text data mining
install.packages("tidytext")
library(tidytext)
install.packages("pdftools")
library(pdftools)
# import companies credit bureau information, stored in PDF format
pdf_text("data/Carnival Coffee.pdf")
# import companies credit bureau information, stored in PDF format
file <- pdf_text("data/Carnival Coffee.pdf")
strsplit(file,"\n")
# import companies credit bureau information, stored in PDF format
file_list <- list.files("data")
file_list
pdf_list <- file_list %>% filter(grepl(".pdf",file_list))
library(dplyr)
file <- pdf_text("data/Carnival Coffee.pdf")
pdf_list <- file_list %>% filter(grepl(".pdf",file_list))
pdf_list <- file_list[grepl(".pdf",file_list)]
pdf_list
pdf_list <- dataframe(file)
pdf_list <- data_frame(file)
pdf_list
pdf_text("data/Carnival Coffee.pdf") %>%
strsplit(file,"\n")->file
pdf_list <- data_frame(file)
pdf_list
pdf_text("data/Carnival Coffee.pdf") %>%
strsplit(file,"\n")->file
file
pdf_text("data/Carnival Coffee.pdf")
pdf_text("data/Carnival Coffee.pdf") %>%
strsplit(file,"\n")
pdf_text("data/Carnival Coffee.pdf") %>%
strsplit("\n")
pdf_text("data/Carnival Coffee.pdf") %>%
strsplit("\n")->file
pdf_list <- data_frame(file)
pdf_list
data_frame(file)
View(file)
pdf_list <- data_frame(as.vector(file))
pdf_list
View(file)
install.packages("janeaustenr")
library(janeaustenr)
book_words <- austen_books() %>%
unnest_tokens(word, text) %>%
count(book, word, sort = TRUE) %>%
ungroup()
austen_books()
austen_books() %>% View()
pdf_list <- data_frame((file))
pdf_list
file
pdf_list <- data.frame((file))
pdf_list
View(pdf_list)
pdf_list <- data.frame((file),names(file))
names(file)
?attr
pdf_list <- data.frame((file),attr(file,name))
pdf_list <- data.frame((file),attr(file,"name"))
pdf_list <- data.frame((file),attr(file,"Name"))
attr(file,"Name")
attr(file)
attributes(file)
deparse(substitute(file))
pdf_text("data/Carnival Coffee.pdf") %>%
strsplit("\n")->document_name
deparse(substitute(document_name))
pdf_list <- data.frame((document_name),substitute(document_name))
pdf_list <- data.frame((document_name),rep(substitute(document_name),length(document_name))
pdf_list <- data.frame((document_name),rep(substitute(document_name),length(document_name)))
pdf_list <- data.frame((document_name),rep(substitute(document_name),length(document_name)))
pdf_list <- data.frame((document_name),rep(substitute(document_name),length(document_name)))
library(tm)
install.packages("tm")
library(tm)
?VCorpus
VCorpus("data/Carnival Coffee.pdf",readerControl = list(reader = readPDF(engine = "ghostscript")))
VCorpus(uri ="data/Carnival Coffee.pdf",readerControl = list(reader = readPDF(engine = "ghostscript")))
VCorpus(URISource( uri ="data/Carnival Coffee.pdf"),readerControl = list(reader = readPDF(engine = "ghostscript")))
VCorpus(URISource( uri ="data/Carnival Coffee.pdf", mode = ""),readerControl = list(reader = readPDF(engine = "ghostscript")))
VCorpus(URISource( uri = "data/Carnival Coffee.pdf", mode = ""),
readerControl = list(reader = readPDF(engine = "ghostscript")))
VCorpus(URISource( uri = file.path("data/Carnival Coffee.pdf"), mode = ""),
readerControl = list(reader = readPDF(engine = "ghostscript")))
VCorpus(URISource( uri = file.path("data/Carnival Coffee.pdf"), mode = ""),
readerControl = list(reader = readPDF(engine = "ghostscript")))
VCorpus(URISource( uri = system.file("data/Carnival Coffee.pdf"), mode = ""),
readerControl = list(reader = readPDF(engine = "ghostscript")))
VCorpus(URISource( uri = system.file("data/Carnival Coffee.pdf", package = "tm"), mode = ""),
readerControl = list(reader = readPDF(engine = "ghostscript")))
VCorpus(URISource( VectorSource("data/Betasoloin.pdf"),
VCorpus(URISource( VectorSource("data/Betasoloin.pdf"),
readerControl = list(reader = readPDF(engine = "ghostscript"))))
VCorpus(URISource( VectorSource("data/Betasoloin.pdf"),
readerControl = list(reader = readPDF(engine = "ghostscript"))))
VCorpus(URISource( VectorSource("data/Betasoloin.pdf"),
readerControl = list(reader = readPDF(engine = "ghostscript"))))
VCorpus(document_name)
